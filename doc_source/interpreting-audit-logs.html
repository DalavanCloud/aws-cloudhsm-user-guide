<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Interpreting HSM Audit Logs - AWS CloudHSM</title>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="home" href="#top" />
      <link rel="up" href="get-hsm-audit-logs-using-cloudwatch.html" title="Monitoring AWS CloudHSM Audit Logs in&#xA;      Amazon CloudWatch Logs" />
      <link rel="prev" href="understand-audit-logs.html" title="Viewing Audit Logs in CloudWatch Logs" />
      <link rel="next" href="cloudhsm-audit-log-reference.html" title="Audit Log Reference" />
      <meta name="description" content="The events in the HSM audit logs have standard fields. Some event types have additional fields that capture useful information about the event. For example, user login and user management events include the user name and user type of the user. Key management commands include the key handle." />
      <meta name="keywords" content="CloudHSM,HSM,hardware security module,HSM appliance,hardware security module appliance,cryptographic key storage,encryption key storage,cryptographic processing,cryptographic operations,cryptographic offload" />
      <meta name="deployment_region" content="SEA" />
      <meta name="product" content="AWS CloudHSM" />
      <meta name="guide" content="User Guide" />
      <meta name="guide-locale" content="en_us" />
      <link rel="icon" type="image/ico" href="images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="images/favicon.ico" />
      <link rel="canonical" href="https://alpha-docs-aws.amazon.com/cloudhsm/latest/userguide/interpreting-audit-logs.html" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css" />
      <link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
      <link rel="stylesheet" type="text/css" href="css/google-font.css" />
      <link id="code-style" rel="stylesheet" type="text/css" href="css/code/light.css" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.theme.css" />
      <link rel="stylesheet" type="text/css" href="css/colorbox.css" />
      <link rel="stylesheet" type="text/css" href="css/awsdocs.css?v=20181116" /><script type="text/javascript" src="js/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/jquery-ui.min.js"></script><script type="text/javascript" src="js/jquery.colorbox.js"></script><script type="text/javascript" src="js/awsdocs.min.js?v=20181116"></script></head>
   <body id="top">
      <div xmlns:db="http://docbook.org/ns/docbook" id="aws-nav" class="aws-nav-header">
         <div class="aws-nav-header-left">
            <div class="aws-nav-logo">
               <!--aws_logo_105x39.png--><a href="http://aws.amazon.com"><img src="images/aws_logo_105x39.png" alt="Amazon Web Services" /></a></div>
         </div>
         <div id="aws-nav-header-right" class="aws-nav-header-right">
            <div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div>
            <div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()">
                  <option value="/de_de/cloudhsm/latest/userguide/interpreting-audit-logs.html">Deutsch</option>
                  <option value="/en_us/cloudhsm/latest/userguide/interpreting-audit-logs.html" selected="selected">English</option>
                  <option value="/es_es/cloudhsm/latest/userguide/interpreting-audit-logs.html">Español</option>
                  <option value="/fr_fr/cloudhsm/latest/userguide/interpreting-audit-logs.html">Français</option>
                  <option value="/it_it/cloudhsm/latest/userguide/interpreting-audit-logs.html">Italiano</option>
                  <option value="/ja_jp/cloudhsm/latest/userguide/interpreting-audit-logs.html">日本語</option>
                  <option value="/ko_kr/cloudhsm/latest/userguide/interpreting-audit-logs.html">한국어</option>
                  <option value="/pt_br/cloudhsm/latest/userguide/interpreting-audit-logs.html">Português</option>
                  <option value="/zh_cn/cloudhsm/latest/userguide/interpreting-audit-logs.html">中文 (简体)</option>
                  <option value="/zh_tw/cloudhsm/latest/userguide/interpreting-audit-logs.html">中文 (繁體)</option></select></div><a class="btn btn-rss-link" id="rss-link-top" target="_blank" href="amazon-cloudhsm-release-notes.rss" title="View RSS Feed"></a><a class="btn btn-kindle-link" id="kindle-link-top" target="_blank" href="http://www.amazon.com/dp/B079BV9BS8" title="Open Kindle"></a><a class="btn btn-pdf-link" id="pdf-link-top" href="cloudhsm-user-guide.pdf#interpreting-audit-logs" target="_blank" title="Open PDF"></a><a class="btn btn-github-link" id="github-link-top" href="https://github.com/awsdocs/aws-cloudhsm-user-guide/tree/master/doc_source/interpreting-audit-logs.md" target="_blank" title="Edit on GitHub"></a><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator">
               <div class="aws-nav-left"></div>
               <div class="aws-nav-right"></div>
            </div>
         </div>
      </div>
      <div id="content-container">
         <div id="left-column">
            <div id="left-col-header">
               <div xmlns:db="http://docbook.org/ns/docbook" id="left-col-top-content">
                  <div id="service-name">AWS CloudHSM </div>
                  <div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div>
                  <div id="guide-info">User Guide
                     <div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div>
                  </div>
               </div>
               <form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="/search/doc-search.html">
                  <div id="search-form"><select id="search-select" name="searchPath">
                        <option value="all">Entire Site</option>
                        <option value="AWSMarketplace">AMIs from AWS Marketplace</option>
                        <option value="amis">AMIs from All Sources</option>
                        <option value="articles">Articles &amp; Tutorials</option>
                        <option value="products_and_info">AWS Product Information</option>
                        <option value="case_studies">Case Studies</option>
                        <option value="customerapps">Customer Apps</option>
                        <option value="documentation">Documentation</option>
                        <option value="documentation-product">Documentation - This Product</option>
                        <option value="documentation-guide" selected="selected">Documentation - This Guide</option>
                        <option value="datasets">Public Data Sets</option>
                        <option value="releasenotes">Release Notes</option>
                        <option value="solution_providers">Partners</option>
                        <option value="code">Sample Code &amp; Libraries</option></select><br /><input id="search-query" name="searchQuery" type="text" placeholder="Search" /><input id="search-button" src="images/search-button.png" alt="Go" type="image" /></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="AWS CloudHSM" /><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="User Guide" /><input type="hidden" name="doc_locale" value="en_us" /></form>
            </div>
            <div id="toc">
               <ul class="awstoc">
                  <li class="awstoc closed"><a class="awstoc" href="introduction.html">What Is AWS CloudHSM?</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="use-cases.html">Use Cases</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="clusters.html">Clusters</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="backups.html">Backups</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="client-tools-and-libraries.html">Client Tools and Libraries</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="hsm-users.html">HSM Users</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="compliance.html">Compliance</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="pricing.html">Pricing</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="regions.html">Regions</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="limits.html">Limits</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="getting-started.html">Getting Started</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="create-iam-user.html">Create IAM Administrators</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="create-vpc.html">Create a VPC</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="create-subnets.html">Create a Private Subnet</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="create-cluster.html">Create a Cluster</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="launch-client-instance.html">Launch an EC2 Client</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="create-hsm.html">Create an HSM</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="verify-hsm-identity.html">Verify HSM Identity (Optional)</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="initialize-cluster.html">Initialize the Cluster</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="install-and-configure-client-linux.html">Install the Client (Linux)</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="install-and-configure-client-win.html">Install the Client (Windows)</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="activate-cluster.html">Activate the Cluster</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="getting-started-ssl.html">Reconfigure SSL (Optional)</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="manage-clusters.html">Managing Clusters</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="add-remove-hsm.html">Adding or Removing HSMs</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="copy-backup-to-region.html">Copying a Backup Across Regions</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="create-cluster-from-backup.html">Creating a Cluster From a Backup</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="delete-restore-backup.html">Deleting and Restoring a Backup</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="delete-cluster.html">Deleting a Cluster</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="tag-resources.html">Tagging Resources</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="manage-hsm-users-and-keys.html">Managing HSM Users and Keys</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="manage-hsm-users.html">Managing HSM Users</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="manage-keys.html">Managing Keys</a></li>
                        <li class="awstoc closed"><a class="awstoc" href="quorum-authentication.html">Quorum Authentication (M of N)</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="quorum-authentication-crypto-officers-first-time-setup.html">First Time Setup for Crypto Officers</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="quorum-authentication-crypto-officers.html">Quorum Authentication for Crypto Officers</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="quorum-authentication-crypto-officers-change-minimum-value.html">Change the Quorum Value for Crypto Officers</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="command-line-tools.html">Command Line Tools</a><ul class="awstoc">
                        <li class="awstoc closed"><a class="awstoc" href="cloudhsm_mgmt_util.html">cloudhsm_mgmt_util</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-getting-started.html">Getting Started</a></li>
                              <li class="awstoc closed"><a class="awstoc" href="cloudhsm_mgmt_util-reference.html">Reference</a><ul class="awstoc">
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-changePswd.html">changePswd</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-createUser.html">createUser</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-deleteUser.html">deleteUser</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-findAllKeys.html">findAllKeys</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-getAttribute.html">getAttribute</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-getCert.html">getCert</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-getHSMInfo.html">getHSMInfo</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-getKeyInfo.html">getKeyInfo</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-info.html">info</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-listAttributes.html">listAttributes</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-listUsers.html">listUsers</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-loginLogout.html">loginHSM and logoutHSM</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-server.html">server</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-setAttribute.html">setAttribute</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-quit.html">quit</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-shareKey.html">shareKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="cloudhsm_mgmt_util-syncKey.html">syncKey</a></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="key_mgmt_util.html">key_mgmt_util</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-getting-started.html">Getting Started</a></li>
                              <li class="awstoc closed"><a class="awstoc" href="key_mgmt_util-reference.html">Reference</a><ul class="awstoc">
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-aesWrapUnwrap.html">aesWrapUnwrap</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-deleteKey.html">deleteKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-Error2String.html">Error2String</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-exSymKey.html">exSymKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-findKey.html">findKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-findSingleKey.html">findSingleKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-genDSAKeyPair.html">genDSAKeyPair</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-genECCKeyPair.html">genECCKeyPair</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-genPBEKey.html">genPBEKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-genRSAKeyPair.html">genRSAKeyPair</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-genSymKey.html">genSymKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-getAttribute.html">getAttribute</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-getKeyInfo.html">getKeyInfo</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-imSymKey.html">imSymKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-listAttributes.html">listAttributes</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-listUsers.html">listUsers</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-setAttribute.html">setAttribute</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-unwrapKey.html">unWrapKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key_mgmt_util-wrapKey.html">wrapKey</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="key-attribute-table.html">Key Attribute Reference</a></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li class="awstoc leaf"><a class="awstoc" href="configure-tool.html">Configure Tool</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="use-hsm.html">Using the Software Libraries</a><ul class="awstoc">
                        <li class="awstoc closed"><a class="awstoc" href="pkcs11-library.html">PKCS #11 Library</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="pkcs11-library-install.html">Installing the PKCS #11 Library</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="pkcs11-pin.html">Authenticating to PKCS #11</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="pkcs11-key-types.html">Supported PKCS #11 Key Types</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="pkcs11-mechanisms.html">Supported PKCS #11 Mechanisms</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="pkcs11-apis.html">Supported PKCS #11 API operations</a></li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="openssl-library.html">OpenSSL Dynamic Engine</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="openssl-library-install.html">Installing the OpenSSL Dynamic Engine</a></li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="java-library.html">Java Library</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="java-library-install.html">Installing the Java Library</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="java-lib-supported.html">Supported Mechanisms</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="java-library-sample.html">Sample Prerequisites</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="java-samples.html">Java Samples</a></li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="ksp-library.html">KSP and CNG Providers</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="ksp-library-install.html">Install the Providers</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="ksp-library-prereq.html">Prerequisites</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="ksp-library-sample.html">Code Sample</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="third-party-applications.html">Integrating Third-Party Applications</a><ul class="awstoc">
                        <li class="awstoc closed"><a class="awstoc" href="ssl-offload.html">SSL/TLS Offload</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-overview.html">How It Works</a></li>
                              <li class="awstoc closed"><a class="awstoc" href="ssl-offload-linux.html">SSL/TLS Offload on Linux</a><ul class="awstoc">
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-prerequisites.html">Step 1: Set Up the Prerequisites</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-import-or-generate-private-key-and-certificate.html">Step 2: Generate or Import a Private Key and SSL/TLS Certificate</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-configure-web-server.html">Step 3: Configure the Web Server</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-enable-traffic-and-verify-certificate.html">Step 4: Enable HTTPS Traffic and Verify the Certificate</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-add-load-balancing.html">(Optional) Step 5: Add a Load Balancer with Elastic Load Balancing</a></li>
                                 </ul>
                              </li>
                              <li class="awstoc closed"><a class="awstoc" href="ssl-offload-windows.html">SSL/TLS Offload on Windows</a><ul class="awstoc">
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-prerequisites-windows.html">Step 1: Set Up the Prerequisites</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-windows-create-csr-and-certificate.html">Step 2: Create a Certificate Signing Request (CSR) and Certificate</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-configure-web-server-windows.html">Step 3: Configure the Web Server</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-enable-traffic-and-verify-certificate-windows.html">Step 4: Enable HTTPS Traffic and Verify the Certificate</a></li>
                                    <li class="awstoc leaf"><a class="awstoc" href="ssl-offload-add-load-balancing-windows.html">(Optional) Step 5: Add a Load Balancer with Elastic Load Balancing</a></li>
                                 </ul>
                              </li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="win-ca-overview.html">Windows Server CA</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="win-ca-prerequisites.html">Set Up Prerequisites</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="win-ca-setup.html">Create Windows Server CA</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="win-ca-sign-csr.html">Sign a CSR</a></li>
                           </ul>
                        </li>
                        <li class="awstoc closed"><a class="awstoc" href="oracle-tde.html">Oracle Database Encryption</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="oracle-tde-prerequisites.html">Set Up Prerequisites</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="oracle-tde-configure-database-and-generate-master-key.html">Configure the Database</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
                  <li class="awstoc opened"><a class="awstoc" href="get-logs.html">Monitoring Logs</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="hsm-client-logs.html">Getting Client Logs</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="get-api-logs-using-cloudtrail.html">Logging AWS CloudHSM API Calls with AWS CloudTrail</a></li>
                        <li class="awstoc opened"><a class="awstoc" href="get-hsm-audit-logs-using-cloudwatch.html">Monitoring Audit Logs</a><ul class="awstoc">
                              <li class="awstoc leaf"><a class="awstoc" href="get-audit-logs-from-cloudwatch.html">How Audit Logging Works</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="understand-audit-logs.html">Viewing Audit Logs in CloudWatch Logs</a></li>
                              <li class="awstoc leaf"><a class="awstoc selected" href="interpreting-audit-logs.html">Interpreting HSM Audit Logs</a></li>
                              <li class="awstoc leaf"><a class="awstoc" href="cloudhsm-audit-log-reference.html">Audit Log Reference</a></li>
                           </ul>
                        </li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="hsm-metrics.html">Getting Metrics</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="hsm-metrics-cw.html">Getting CloudWatch Metrics</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="troubleshooting.html">Troubleshooting</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="KnownIssues.html">Known Issues</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="troubleshooting-lost-connection.html">Lost Connection</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="troubleshooting-keep-hsm-users-in-sync.html">Keep HSM Users In Sync</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="troubleshooting-verify-hsm-performance.html">Verify Performance</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="troubleshooting-create-cluster.html">Resolving Cluster Creation Failures</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="troubleshooting-missing-audit-logs.html">Missing AWS CloudHSM Audit Logs in CloudWatch</a></li>
                     </ul>
                  </li>
                  <li class="awstoc closed"><a class="awstoc" href="client-and-software-version-history.html">Client and Software Information</a><ul class="awstoc">
                        <li class="awstoc leaf"><a class="awstoc" href="client-history.html">Version History</a></li>
                        <li class="awstoc leaf"><a class="awstoc" href="client-supported-platforms.html">Supported Platforms</a></li>
                     </ul>
                  </li>
                  <li class="awstoc leaf"><a class="awstoc" href="document-history.html">Document History</a></li>
                  <li id="toc-additional-links"><a class="btn btn-pdf-link" id="pdf-link-alt" href="cloudhsm-user-guide.pdf#top" target="_blank" title="Open PDF"></a><a class="btn btn-kindle-link" id="kindle-link-alt" target="_blank" href="http://www.amazon.com/dp/B079BV9BS8" title="Open Kindle"></a><a class="btn btn-rss-link" id="rss-link-alt" target="_blank" href="amazon-cloudhsm-release-notes.rss" title="View RSS Feed"></a></li>
               </ul>
            </div>
         </div>
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> » <a href="/cloudhsm/index.html">AWS CloudHSM</a> » <a href="index.html">User Guide</a> » <a href="get-logs.html">Monitoring AWS CloudHSM Logs</a> » <a href="get-hsm-audit-logs-using-cloudwatch.html">Monitoring AWS CloudHSM Audit Logs in
                                    Amazon CloudWatch Logs</a> » <span class="breadcrumb">Interpreting HSM Audit Logs</span></div>
                           </td>
                        </tr>
                     </table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div id="SEARegionDisclaimer">This prerelease documentation is confidential and is provided under the terms of your
                        nondisclosure agreement with Amazon Web Services (AWS) or other agreement governing
                        your receipt of AWS confidential information.
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="interpreting-audit-logs">Interpreting HSM Audit Logs</h1>
                     <p>The events in the HSM audit logs have standard fields. Some event types have additional
                        fields that capture useful information about the event. For example, user login and
                        user
                        management events include the user name and user type of the user. Key management
                        commands
                        include the key handle.
                     </p>
                     <p>Several of the fields provide particularly important information. The <code class="code">Opcode</code>
                        identifies the management command that is being recorded. The <code class="code">Sequence No</code>
                        identifies an event in the log stream and indicates the order in which it was recorded.
                        
                     </p>
                     <p>For example, the following example event is the second event (<code class="code">Sequence No:
                           0x1</code>) in the log stream for an HSM. It shows the HSM generating a password encryption
                        key, which is part of its startup routine.
                     </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/19/17 21:01:17.140812, usecs:1513717277140812
Sequence No : 0x1
Reboot counter : 0xe8
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_GEN_PSWD_ENC_KEY (0x1d)
Session Handle : 0x1004001
Response : 0:HSM Return: SUCCESS
Log type : MINIMAL_LOG_ENTRY (0)</code></pre><p>The following fields are common to every AWS CloudHSM event in the audit log. </p>
                     <div class="variablelist">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><b><span class="term">Time</span></b></dt>
                           
                           <dd>
                              
                              <p>The time that the event occurred in the UTC time zone. The time is displayed as a
                                 human-readable time and Unix time in microseconds. 
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Reboot counter</span></b></dt>
                           
                           <dd>
                              
                              <p>A 32-bit persistent ordinal counter that is incremented when the HSM hardware is
                                 rebooted. 
                              </p>
                              
                              <p>All events in a log stream have the same reboot counter value. However, the reboot
                                 counter might not be unique to a log stream, as it can differ across different HSM
                                 instances in the same cluster.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Sequence No</span></b></dt>
                           
                           <dd>
                              
                              <p>A 64-bit ordinal counter that is incremented for each log event. The first event in
                                 each log stream has a sequence number of 0x0. There should be no gaps in the
                                 <code class="code">Sequence No</code> values. The sequence number is unique only within a log
                                 stream.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Command type</span></b></dt>
                           
                           <dd>
                              
                              <p>A hexadecimal value that represents the category of the command. Commands in the
                                 AWS CloudHSM log streams have a command type of <code class="code">CN_MGMT_CMD</code> (0x0) or
                                 <code class="code">CN_CERT_AUTH_CMD</code> (0x9).
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Opcode</span></b></dt>
                           
                           <dd>
                              
                              <p>Identifies the management command that was executed. For a list of
                                 <code class="code">Opcode</code> values in the AWS CloudHSM audit logs, see <a href="cloudhsm-audit-log-reference.html">Audit Log Reference</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Session handle</span></b></dt>
                           
                           <dd>
                              
                              <p>Identifies the session in which the command was run and the event was logged.</p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Response</span></b></dt>
                           
                           <dd>
                              
                              <p>Records the response to the management command. You can search the
                                 <code class="code">Response</code> field for <code class="code">SUCCESS</code> and <code class="code">ERROR</code>
                                 values.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><b><span class="term">Log type</span></b></dt>
                           
                           <dd>
                              
                              <p>Indicates the log type of the AWS CloudHSM log that recorded the command.</p>
                              
                              <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p><code class="code">MINIMAL_LOG_ENTRY (0)</code></p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p><code class="code">MGMT_KEY_DETAILS_LOG (1)</code></p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p><code class="code">MGMT_USER_DETAILS_LOG (2)</code></p>
                                       
                                    </li>
                                    <li class="listitem">
                                       
                                       <p><code class="code">GENERIC_LOG</code></p>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                           </dd>
                           
                        </dl>
                     </div>
                     
                     <h2 id="example-audit-log">Examples of Audit Log Events</h2>
                     
                     <p>The events in a log stream record the history of the HSM from its creation to deletion.
                        You can use the log to review the lifecycle of your HSMs and gain insight into its
                        operation.
                        When you interpret the events, note the <code class="code">Opcode</code>, which indicates the management
                        command or action, and the <code class="code">Sequence No</code>, which indicates the order of events. 
                     </p>
                     
                     <div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#example-audit-log-first-hsm">Example: Initialize the First HSM in a
                                 Cluster</a></li>
                           <li><a href="#example-audit-log-login-logout">Login and Logout Events</a></li>
                           <li><a href="#example-audit-log-first-hsm">Example: Create and Delete Users</a></li>
                           <li><a href="#example-audit-log-manage-keys">Example: Create and Delete a Key
                                 Pair</a></li>
                           <li><a href="#audit-log-example-gen-key">Example: Generate and Synchronize a Key</a></li>
                           <li><a href="#audit-log-example-export-key">Example: Export a Key</a></li>
                           <li><a href="#audit-log-example-import-key">Example: Import a Key</a></li>
                        </ul>
                     </div>
                     
                     
                     
                     <h3 id="example-audit-log-first-hsm">Example: Initialize the First HSM in a
                        Cluster
                     </h3>
                     
                     <p>The audit log stream for the first HSM in each cluster differs significantly from
                        the
                        log streams of other HSMs in the cluster. The audit log for the first HSM in each
                        cluster
                        records its creation and initialization. The logs of additional HSMs in the cluster,
                        which
                        are generated from backups, begin with a login event.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>The following initialization entries will not appear in the CloudWatch logs of clusters
                           initialized before the release of the CloudHSM audit logging feature (August 30, 2018).
                           For more information, see <a href="document-history.html">Document History</a>.
                        </p>
                     </div>
                     
                     <p>The following example events appear in the log stream for the first HSM in a cluster.
                        The first event in the log — the one with <code class="code">Sequence No 0x0</code> —
                        represents the command to initialize the HSM (<code class="code">CN_INIT_TOKEN</code>). The response
                        indicates that the command was successful (<code class="code">Response : 0: HSM Return:
                           SUCCESS</code>).
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/19/17 21:01:16.962174, usecs:1513717276962174
Sequence No : 0x0
Reboot counter : 0xe8
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_INIT_TOKEN (0x1)
Session Handle : 0x1004001
Response : 0:HSM Return: SUCCESS
Log type : MINIMAL_LOG_ENTRY (0)</code></pre>
                     <p>The second event in this example log stream (<code class="code">Sequence No 0x1</code>) records the
                        command to create the password encryption key that the HSM uses
                        (<code class="code">CN_GEN_PSWD_ENC_KEY</code>). 
                     </p>
                     
                     <p>This is a typical startup sequence for the first HSM in each cluster. Because subsequent
                        HSMs in the same cluster are clones of the first one, they use the same password encryption
                        key.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/19/17 21:01:17.140812, usecs:1513717277140812
Sequence No : 0x1
Reboot counter : 0xe8
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_GEN_PSWD_ENC_KEY (0x1d)
Session Handle : 0x1004001
Response : 0:HSM Return: SUCCESS
Log type : MINIMAL_LOG_ENTRY (0)</code></pre>
                     <p>The third event in this example log stream (<code class="code">Sequence No 0x2</code>) is the
                        creation of the <a href="hsm-users.html#appliance-user">appliance user (AU)</a>, which is the
                        AWS CloudHSM service. Events that involve HSM users include extra fields for the user
                        name and user
                        type. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/19/17 21:01:17.174902, usecs:1513717277174902
Sequence No : 0x2
Reboot counter : 0xe8
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_CREATE_APPLIANCE_USER (0xfc)
Session Handle : 0x1004001
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : app_user
User Type : CN_APPLIANCE_USER (5)</code></pre>
                     <p>The fourth event in this example log stream (<code class="code">Sequence No 0x3</code>) records the
                        <code class="code">CN_INIT_DONE</code> event, which completes the initialization of the HSM. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/19/17 21:01:17.298914, usecs:1513717277298914
Sequence No : 0x3
Reboot counter : 0xe8
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_INIT_DONE (0x95)
Session Handle : 0x1004001
Response : 0:HSM Return: SUCCESS
Log type : MINIMAL_LOG_ENTRY (0)</code></pre>
                     <p>You can follow the remaining events in the startup sequence, which might include several
                        login and logout events, and the generation of the key encryption key (KEK). The following
                        event records the command that changes the password of the <a href="hsm-users.html#preco">precrypto
                           officer (PRECO)</a>. This command activates the cluster.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:04:33.846554, usecs:1513206273846554
Sequence No: 0x1d
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_CHANGE_PSWD (0x9)
Session Handle: 0x2010003
Response: 0:HSM Return: SUCCESS
Log type: MGMT_USER_DETAILS_LOG (2)
User Name: admin
User Type: CN_CRYPTO_PRE_OFFICER (6)</code></pre>
                     
                     
                     <h3 id="example-audit-log-login-logout">Login and Logout Events</h3>
                     
                     <p>When interpreting your audit log, note events that record users logging and in and
                        out
                        of the HSM. These events help you to determine which user is responsible for management
                        commands that appear in sequence between the login and logout commands.
                     </p>
                     
                     <p>For example, this log entry records a login by a crypto officer named
                        <code class="code">admin</code>. The sequence number, <code class="code">0x0</code>, indicates that this is the first
                        event in this log stream. 
                     </p>
                     
                     <p>When a user logs into an HSM, the other HSMs in the cluster also record a login event
                        for the user. You can find the corresponding login events in the log streams of other
                        HSMs
                        in the cluster shortly after the initial login event. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/16/18 01:48:49.824999, usecs:1516067329824999
Sequence No : 0x0
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0x7014006
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : admin
User Type : CN_CRYPTO_OFFICER (2)</code></pre>
                     <p>The following example event records the <code class="code">admin</code> crypto officer logging out.
                        The sequence number, <code class="code">0x2</code>, indicates that this is the third event in the log
                        stream. 
                     </p>
                     
                     <p>If the logged in user closes the session without logging out, the log stream includes
                        an
                        <code class="code">CN_APP_FINALIZE</code> or close session event (<code class="code">CN_SESSION_CLOSE</code>),
                        instead of a <code class="code">CN_LOGOUT</code> event. Unlike the login event, this logout event
                        typically is recorded only by the HSM that executes the command.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/16/18 01:49:55.993404, usecs:1516067395993404
Sequence No : 0x2
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGOUT (0xe)
Session Handle : 0x7014000
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : admin
User Type : CN_CRYPTO_OFFICER (2)</code></pre>
                     <p>If a login attempt fails because the user name is invalid, the HSM records a
                        <code class="code">CN_LOGIN</code> event with the user name and type provided in the login command. The
                        response displays error message 157, which explains that the user name does not
                        exist.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 17:41:39.037255, usecs:1516815699037255
Sequence No : 0x4
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0xc008002
Response : 157:HSM Error: user isn't initialized or user with this name doesn't exist
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : ExampleUser
User Type : CN_CRYPTO_USER (1)</code></pre>
                     <p>If a login attempt fails because the password is invalid, the HSM records a
                        <code class="code">CN_LOGIN</code> event with the user name and type provided in the login command. The
                        response displays the error message with the <code class="code">RET_USER_LOGIN_FAILURE</code> error
                        code.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 17:44:25.013218, usecs:1516815865013218
Sequence No : 0x5
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0xc008002
Response : 163:HSM Error: RET_USER_LOGIN_FAILURE
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : testuser
User Type : CN_CRYPTO_USER (1)</code></pre>
                     
                     
                     
                     <h3 id="example-audit-log-first-hsm">Example: Create and Delete Users</h3>
                     
                     <p>This example shows the log events that are recorded when a crypto officer (CO) creates
                        and deletes users. 
                     </p>
                     
                     <p>The first event records a CO, <code class="code">admin</code>, logging into the HSM. The sequence
                        number of <code class="code">0x0</code> indicates that this is the first event in the log stream. The
                        name and type of the user who logged in are included in the event.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/16/18 01:48:49.824999, usecs:1516067329824999
Sequence No : 0x0
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0x7014006
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : admin
User Type : CN_CRYPTO_OFFICER (2)</code></pre>
                     <p>The next event in the log stream (sequence <code class="code">0x1</code>) records the CO creating a
                        new crypto user (CU). The name and type of the new user are included in the event.
                        
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/16/18 01:49:39.437708, usecs:1516067379437708
Sequence No : 0x1
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_CREATE_USER (0x3)
Session Handle : 0x7014006
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : bob
User Type : CN_CRYPTO_USER (1)</code></pre>
                     <p>Then, the CO creates another crypto officer, <code class="code">alice</code>. The sequence number
                        indicates that this action followed the previous one with no intervening actions.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/16/18 01:49:55.993404, usecs:1516067395993404
Sequence No : 0x2
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_CREATE_CO (0x4)
Session Handle : 0x7014007
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : alice
User Type : CN_CRYPTO_OFFICER (2)</code></pre>
                     <p>Later, the CO named <code class="code">admin</code> logs in and deletes the crypto officer named
                        <code class="code">alice</code>. The HSM records a <code class="code">CN_DELETE_USER</code> event. The name and type
                        of the deleted user are included in the event.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/23/18 19:58:23.451420, usecs:1516737503451420
Sequence No : 0xb
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_DELETE_USER (0xa1)
Session Handle : 0x7014007
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : alice
User Type : CN_CRYPTO_OFFICER (2)</code></pre>
                     
                     
                     
                     <h3 id="example-audit-log-manage-keys">Example: Create and Delete a Key
                        Pair
                     </h3>
                     
                     <p>This example shows the events that are recorded in an HSM audit log when you create
                        and
                        delete a key pair. 
                     </p>
                     
                     <p>The following event records the crypto user (CU) named <code class="code">crypto_user</code> logging
                        in to the HSM. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:09:04.648952, usecs:1513206544648952
Sequence No: 0x28
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_LOGIN (0xd)
Session Handle: 0x2014005
Response: 0:HSM Return: SUCCESS
Log type: MGMT_USER_DETAILS_LOG (2)
User Name: crypto_user
User Type: CN_CRYPTO_USER (1)</code></pre>
                     <p>Next, the CU generates a key pair (<code class="code">CN_GENERATE_KEY_PAIR</code>). The private key
                        has key handle <code class="code">131079</code>. The public key has key handle <code class="code">131078</code>. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:09:04.761594, usecs:1513206544761594
Sequence No: 0x29
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_GENERATE_KEY_PAIR (0x19)
Session Handle: 0x2014004
Response: 0:HSM Return: SUCCESS
Log type: MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle: 131079
Public Key Handle: 131078</code></pre>
                     <p>The CU immediately deletes the key pair. A CN_DESTROY_OBJECT event records the deletion
                        of the public key (131078). 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:09:04.813977, usecs:1513206544813977
Sequence No: 0x2a
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_DESTROY_OBJECT (0x11)
Session Handle: 0x2014004
Response: 0:HSM Return: SUCCESS
Log type: MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle: 131078
Public Key Handle: 0</code></pre>
                     <p>Then, a second <code class="code">CN_DESTROY_OBJECT</code> event records the deletion of the private
                        key (<code class="code">131079</code>).
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:09:04.815530, usecs:1513206544815530
Sequence No: 0x2b
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_DESTROY_OBJECT (0x11)
Session Handle: 0x2014004
Response: 0:HSM Return: SUCCESS
Log type: MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle: 131079
Public Key Handle: 0</code></pre>
                     <p>Finally, the CU logs out. </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 12/13/17 23:09:04.817222, usecs:1513206544817222
Sequence No: 0x2c
Reboot counter: 0xe8
Command Type(hex): CN_MGMT_CMD (0x0)
Opcode: CN_LOGOUT (0xe)
Session Handle: 0x2014004
Response: 0:HSM Return: SUCCESS
Log type: MGMT_USER_DETAILS_LOG (2)
User Name: crypto_user
User Type: CN_CRYPTO_USER (1)</code></pre>
                     
                     
                     
                     <h3 id="audit-log-example-gen-key">Example: Generate and Synchronize a Key</h3>
                     
                     <p>This example shows the effect of creating a key in a cluster with multiple HSMs. The
                        key
                        is generated on one HSM, extracted from the HSM as a masked object, and inserted in
                        the
                        other HSMs as a masked object.
                     </p>
                     
                     <div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>The client tools might fail to synchronize the key, or the command might include the
                           <b>min_srv</b> parameter, which synchronizes the key only to the specified
                           number of HSMs. In either case, the AWS CloudHSM service synchronizes the key to the
                           other HSMs
                           in the cluster. Because the HSMs record only client-side management commands in their
                           logs, the server-side synchronization is not recorded in the HSM log.
                        </p>
                     </div>
                     
                     <p>First consider the log stream of the HSM that receives and executes the commands.
                        The
                        log stream is named for HSM ID, <code class="code">hsm-abcde123456</code>, but the HSM ID does not appear
                        in the log events. 
                     </p>
                     
                     <p>First, the <code class="code">testuser</code> crypto user (CU) logs in to the
                        <code class="code">hsm-abcde123456</code> HSM.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 00:39:23.172777, usecs:1516754363172777
Sequence No : 0x0
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0xc008002
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : testuser
User Type : CN_CRYPTO_USER (1)</code></pre>
                     <p>The CU runs an <a href="key_mgmt_util-genSymKey.html">exSymKey</a> command to
                        generate a symmetric key. The <code class="code">hsm-abcde123456</code> HSM generates a symmetric key
                        with a key handle of <code class="code">262152</code>. The HSM records a <code class="code">CN_GENERATE_KEY</code>
                        event in its log. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 00:39:30.328334, usecs:1516754370328334
Sequence No : 0x1
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_GENERATE_KEY (0x17)
Session Handle : 0xc008004
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 262152
Public Key Handle : 0</code></pre>
                     <p>The next event in the log stream for <code class="code">hsm-abcde123456</code> records the first step
                        in the key synchronization process. The new key (key handle <code class="code">262152</code>) is
                        extracted from the HSM as a masked object. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 00:39:30.330956, usecs:1516754370330956
Sequence No : 0x2
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_EXTRACT_MASKED_OBJECT_USER (0xf0)
Session Handle : 0xc008004
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 262152
Public Key Handle : 0</code></pre>
                     <p>Now consider the log stream for HSM <code class="code">hsm-zyxwv987654</code>, another HSM in the
                        same cluster. This log stream also includes a login event for the <code class="code">testuser</code> CU.
                        The time value shows that occurs shortly after the user logs in to the
                        <code class="code">hsm-abcde123456</code> HSM.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 00:39:23.199740, usecs:1516754363199740
Sequence No : 0xd
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0x7004004
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : testuser
User Type : CN_CRYPTO_USER (1)</code></pre>
                     <p>This log stream for this HSM does not have a <code class="code">CN_GENERATE_KEY</code> event. But it
                        does have an event that records synchronization of the key to this HSM. The
                        <code class="code">CN_INSERT_MASKED_OBJECT_USER</code> event records the receipt of key
                        <code class="code">262152</code> as a masked object. Now key <code class="code">262152</code> exists on both HSMs in
                        the cluster.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 00:39:30.408950, usecs:1516754370408950
Sequence No : 0xe
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_INSERT_MASKED_OBJECT_USER (0xf1)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 262152
Public Key Handle : 0</code></pre>
                     <p>When the CU user logs out, this <code class="code">CN_LOGOUT</code> event appears only in the log
                        stream of the HSM that received the commands. 
                     </p>
                     
                     
                     
                     
                     <h3 id="audit-log-example-export-key">Example: Export a Key</h3>
                     
                     <p>This example shows the audit log events that are recorded when a crypto user (CU)
                        exports keys from a cluster with multiple HSMs. 
                     </p>
                     
                     <p>The following event records the CU (<code class="code">testuser</code>) logging into <a href="key_mgmt_util.html">key_mgmt_util</a>. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:42:22.695884, usecs:1516822942695884
Sequence No : 0x26
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_LOGIN (0xd)
Session Handle : 0x7004004
Response : 0:HSM Return: SUCCESS
Log type : MGMT_USER_DETAILS_LOG (2)
User Name : testuser
User Type : CN_CRYPTO_USER (1)</code></pre>
                     <p>The CU runs an <a href="key_mgmt_util-exSymKey.html">exSymKey</a> command to export
                        key <code class="code">7</code>, a 256-bit AES key. The command uses key <code class="code">6</code>, a 256-bit AES
                        key on the HSMs, as the wrapping key. 
                     </p>
                     
                     <p>The HSM that receives the command records a <code class="code">CN_WRAP_KEY</code> event for key
                        <code class="code">7</code>, the key that is being exported. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:51:12.860123, usecs:1516823472860123
Sequence No : 0x27
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_WRAP_KEY (0x1a)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 7
Public Key Handle : 0</code></pre>
                     <p>Then, the HSM records a <code class="code">CN_NIST_AES_WRAP</code> event for the wrapping key, key
                        <code class="code">6</code>. The key is wrapped and then immediately unwrapped, but the HSM records
                        only one event.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:51:12.905257, usecs:1516823472905257
Sequence No : 0x28
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_NIST_AES_WRAP (0x1e)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 6
Public Key Handle : 0</code></pre>
                     <p>The <b>exSymKey</b> command writes the exported key to a file but does not
                        change the key on the HSM. Consequently, there are no corresponding events in the
                        logs of
                        other HSMs in the cluster. 
                     </p>
                     
                     
                     
                     
                     <h3 id="audit-log-example-import-key">Example: Import a Key</h3>
                     
                     <p>This example shows the audit log events that are recorded when you import keys into
                        the
                        HSMs in a cluster. In this example, the crypto user (CU) uses the <a href="key_mgmt_util-imSymKey.html">imSymKey</a> command to import an AES key into the
                        HSMs. The command uses key <code class="code">6</code> as the wrapping key. 
                     </p>
                     
                     <p>The HSM that receives the commands first records a <code class="code">CN_NIST_AES_WRAP</code> event
                        for key <code class="code">6</code>, the wrapping key. 
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:58:23.170518, usecs:1516823903170518
Sequence No : 0x29
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_NIST_AES_WRAP (0x1e)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 6
Public Key Handle : 0</code></pre>
                     <p>Then, the HSM records a <code class="code">CN_UNWRAP_KEY</code> event that represents the import
                        operation. The imported key is assigned a key handle of <code class="code">11</code>.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:58:23.200711, usecs:1516823903200711
Sequence No : 0x2a
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_UNWRAP_KEY (0x1b)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 11
Public Key Handle : 0</code></pre>
                     <p>When a new key is generated or imported, the client tools automatically attempt to
                        synchronize the new key to other HSMs in the cluster. In this case, the HSM records
                        a
                        <code class="code">CN_EXTRACT_MASKED_OBJECT_USER</code> event when key <code class="code">11</code> is extracted
                        from the HSM as a masked object.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:58:23.203350, usecs:1516823903203350
Sequence No : 0x2b
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_EXTRACT_MASKED_OBJECT_USER (0xf0)
Session Handle : 0x7004003
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 11
Public Key Handle : 0</code></pre>
                     <p>The log streams of other HSMs in the cluster reflect the arrival of the newly imported
                        key. 
                     </p>
                     
                     <p>For example, this event was recorded in the log stream of a different HSM in the same
                        cluster. This <code class="code">CN_INSERT_MASKED_OBJECT_USER</code> event records the arrival of a
                        masked object that represents key <code class="code">11</code>.
                     </p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">Time: 01/24/18 19:58:23.286793, usecs:1516823903286793
Sequence No : 0xb
Reboot counter : 0x107
Command Type(hex) : CN_MGMT_CMD (0x0)
Opcode : CN_INSERT_MASKED_OBJECT_USER (0xf1)
Session Handle : 0xc008004
Response : 0:HSM Return: SUCCESS
Log type : MGMT_KEY_DETAILS_LOG (1)
Priv/Secret Key Handle : 11
Public Key Handle : 0</code></pre>
                     
                     </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="understand-audit-logs.html">« Previous </a><a class="awstoc" accesskey="n" href="cloudhsm-audit-log-reference.html">Next »</a></div>
                     <div id="copyright-main-footer">© 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Examples of Audit Log Events"><a class="pagetoc" href="#example-audit-log">Examples of Audit Log Events</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using our site, you consent
            to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      <div id="footer">
         <div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://alpha-docs-aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=cdcb09fa-3f0a-4265-9254-d796483b9489&amp;topic_url=http://alpha-docs-aws.amazon.com/en_us/cloudhsm/latest/userguide/interpreting-audit-logs.html&amp;hidden_guide_name=User Guide&amp;hidden_api_version=&amp;hidden_file_name=interpreting-audit-logs"><i class="awsdocs-footer-text fa fa-envelope-o"></i></a></div>
         <div id="footer_toggle" class="mediaobject">
            <div id="footer_toggle_img" class="awsdocs-footer-text fa fa-caret-down"></div>
            <div id="footer_toggle_img_collapse" class="hide awsdocs-footer-text fa fa-caret-right"></div>
         </div>
         <div id="footer-left"><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/terms">Terms of Use</a><span class="awsdocs-footer-text"> | </span><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/privacy">Privacy</a><span class="awsdocs-footer-text"> | </span><span class="awsdocs-footer-text">© 2018, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span></div>
         <div id="footer-right">
            <div id="feedback">
               <div id="forums"><a id="forum_link" target="_blank" href="http://forums.aws.amazon.com/forum.jspa?forumID=156" class="awsdocs-footer-text">Have a question? Try the Forums.</a></div>
               <div id="feedback-message" class="awsdocs-footer-text">Did this page help you?</div>
               <div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes.html?topic_url=http://alpha-docs-aws.amazon.com/en_us/cloudhsm/latest/userguide/interpreting-audit-logs.html">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno.html?topic_url=http://alpha-docs-aws.amazon.com/en_us/cloudhsm/latest/userguide/interpreting-audit-logs.html">No</a></div>
               <div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://alpha-docs-aws.amazon.com/forms/aws-doc-feedback?feedback_destination_id=cdcb09fa-3f0a-4265-9254-d796483b9489&amp;topic_url=http://alpha-docs-aws.amazon.com/en_us/cloudhsm/latest/userguide/interpreting-audit-logs.html&amp;hidden_guide_name=User Guide&amp;hidden_api_version=&amp;hidden_file_name=interpreting-audit-logs">Feedback</a></div>
            </div>
         </div>
      </div>
   </body>
</html>